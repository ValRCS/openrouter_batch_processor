<!doctype html>
<html>
  <head>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/style.css') }}">
  </head>
  <body>
    <div class="container jobs-container">
      <h1>Jobs Archive</h1>
      {% macro sort_links(field) -%}
        <a class="sort-arrow{% if sort_by == field and sort_dir == 'asc' %} active{% endif %}" href="{{ url_for('jobs_archive', sort_by=field, sort_dir='asc') }}">^</a>
        <a class="sort-arrow{% if sort_by == field and sort_dir == 'desc' %} active{% endif %}" href="{{ url_for('jobs_archive', sort_by=field, sort_dir='desc') }}">v</a>
      {%- endmacro %}
      <table class="jobs-table">
        <thead>
          <tr>
            <th>Job ID</th>
            <th class="sortable">Submitted At {{ sort_links("submitted_at") }}</th>
            <th class="sortable">Model {{ sort_links("model") }}</th>
            <th class="sortable">Status {{ sort_links("status") }}</th>
            <th class="sortable">Route {{ sort_links("route") }}</th>
            <th class="sortable">Filename {{ sort_links("filename") }}</th>
            <th class="sortable">Elapsed Time {{ sort_links("elapsed_time") }}</th>
            <th>Inputs</th>
            <th>Outputs</th>
          </tr>
        </thead>
        <tbody>
          {% for job in jobs %}
            <tr>
              <td>{{ job.job_id }}</td>
              <td>{{ job.submitted_at }}</td>
              <td>{{ job.model }}</td>
              <td>{{ job.status }}</td>
              <td>{{ job.route }}</td>
              <td>{{ job.zip_filename or "-" }}</td>
              <td>{{ job.elapsed_time or "-" }}</td>
              <td>
                {% if job.input_download_url %}
                  <a href="{{ job.input_download_url }}" title="Download input files">Download Inputs Zip</a>
                  {% if job.input_zip_name %}
                    <div><code>{{ job.input_zip_name }}</code></div>
                  {% endif %}
                  {% if job.input_zip_hash %}
                    <div><code>{{ job.input_zip_hash[:12] }}</code></div>
                  {% endif %}
                {% else %}
                  -
                {% endif %}
              </td>
              <td>
                {% if job.download_url %}
                  <a href="{{ job.download_url }}" title="Download results">Download Outputs Zip</a>
                {% else %}
                  -
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <p><a href="{{ url_for('index') }}">Back to home</a></p>
      <p><a href="{{ url_for('marc') }}">Back to MARC</a></p>
    </div>
  </body>
</html>
